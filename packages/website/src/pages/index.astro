---
import Container from "../components/Container.astro";
import { FeatureSection } from "../components/FeatureSection";
import GetStartedCTA from "../components/GetStartedCTA.astro";
import LinkButton from "../components/LinkButton.astro";
import { PullTriggerSection } from "../components/PullTriggerSection";
import { SpeedUpDevelopment } from "../components/SpeedUpDevelopment";
import DiscordIcon from "../components/icons/DiscordIcon.astro";
import GithubIcon from "../components/icons/GithubIcon.astro";
import TwitterIcon from "../components/icons/TwitterIcon.astro";
import Layout from "../layouts/Layout.astro";
import shapesSrc from "../images/shapes.svg";
import { EasyToUse } from "../components/EasyToUse";
import shiki from "shiki";

const highlighter = await shiki.getHighlighter({
  theme: "github-dark",
  langs: ["jsx"],
});

const provider = highlighter.codeToHtml(
  `import { ProgressivelyProvider } from "@progressively/react";

const App = () => {
  return (
    <ProgressivelyProvider clientKey="YOUR_CLIENT_KEY">
      <FlaggedComponent />
    </ProgressivelyProvider>
  );
};`,
  {
    lang: "jsx",
  }
);

const clientComponent = highlighter.codeToHtml(
  `import { useFlags } from "@progressively/react";

const FlaggedComponent = () => {
  const { flags } = useFlags();

  if (flags.newFlag) {
    return <div>New variant</div>;
  }

  return <div>Old variant</div>;
};`,
  {
    lang: "jsx",
  }
);
---

<Layout title="Welcome to Progressively, the new feature flag solution.">
  <header
    class="bg-slate-900 py-20 md:py-40"
    style={{
      backgroundImage: `url("${shapesSrc}")`,
    }}
  >
    <Container>
      <div
        class="flex justify-center lg:items-center flex-col pb-20 md:pb-40 gap-4"
      >
        <ul class="flex h-12 items-center">
          <li>
            <LinkButton
              variant="tertiary-inverse"
              href="https://github.com/progressively-crew/progressively"
              target={"_blank"}
              id="github"
            >
              <GithubIcon />
            </LinkButton>
          </li>

          <li>
            <LinkButton
              variant="tertiary-inverse"
              href="https://discord.gg/kJ55wBXC37"
              target={"_blank"}
              id="discord"
            >
              <DiscordIcon />
            </LinkButton>
          </li>

          <li>
            <LinkButton
              variant="tertiary-inverse"
              href="https://twitter.com/_progressively"
              target={"_blank"}
              id="twitter"
            >
              <TwitterIcon />
            </LinkButton>
          </li>
        </ul>

        <h1 class="text-5xl md:text-6xl font-extrabold text-white">
          Introducing <span>Progressively</span>
        </h1>

        <p class="text-2xl sm:text-center text-slate-200">
          A simple, accessible, lightweight and OpenSource feature flag
          software.
        </p>

        <div class="flex flex-col sm:flex-row gap-4">
          <LinkButton
            variant="primary-inverse"
            href="https://dashboard.progressively.app/signin"
            target={"_blank"}
            id="demo-instance"
          >
            Get started with SaaS
          </LinkButton>

          <LinkButton
            href="https://docs.progressively.app/start-with-self-hosted/quick-start"
            target={"_blank"}
            id="get-started"
            variant="secondary-inverse"
          >
            Get started locally
          </LinkButton>
        </div>
      </div>

      <div
        class="bg-gradient-to-r from-pink-300 via-purple-300 to-indigo-400 rounded-xl overflow-hidden"
      >
        <div class="md:rounded-lg border border-slate-700 p-2">
          <div style="padding:35.79% 0 0 0;position:relative;">
            <iframe
              src="https://player.vimeo.com/video/838070241?badge=0&autopause=0&player_id=0&app_id=58479"
              frameborder="0"
              allow="autoplay; fullscreen; picture-in-picture"
              allowfullscreen
              style="position:absolute;top:0;left:0;width:100%;height:100%;"
              title="0620"></iframe>
          </div>
        </div>
      </div>
    </Container>
  </header>

  <main>
    <div>
      <SpeedUpDevelopment />

      <PullTriggerSection client:load />

      <EasyToUse provider={provider} clientComponent={clientComponent} />

      <FeatureSection />

      <GetStartedCTA />
    </div>
  </main>
</Layout>

<script src="https://player.vimeo.com/api/player.js"></script>
