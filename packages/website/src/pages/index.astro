---
import { CanaryRelease } from "../components/CanaryRelease";
import { FeatureSection } from "../components/FeatureSection";
import GetStartedCTA from "../components/GetStartedCTA.astro";
import LinkButton from "../components/LinkButton.astro";
import { PullTriggerSection } from "../components/PullTriggerSection";
import { SpeedUpDevelopment } from "../components/SpeedUpDevelopment";
import { CorrelatePercentageError } from "../components/CorrelatePercentageError";
import { ABTesting } from "../components/ABTesting";
import Layout from "../layouts/Layout.astro";
import hljs from "highlight.js";
import { TimeBasedRollout } from "../components/TimeBasedRollout";

const clientComponent = hljs.highlight(
  `
import { useFlags } from "@progressively/react";

const FlaggedComponent = () => {
  const { flags } = useFlags();

  if (flags.newFlag) {
    return <div>New variant</div>;
  }

  return <div>Old variant</div>;
};

`,
  { language: "jsx" }
).value;

const abcVersions = hljs.highlight(
  `
import { useFlags } from "@progressively/react";

const FlaggedComponent = () => {
  const { flags } = useFlags();

  if (flags.newFlag === "B") {
    return <VersionB />;
  }

  if (flags.newFlag === "C") {
    return <VersionC />;
  }

  return <VersionA />;
};

`,
  { language: "jsx" }
).value;
---

<Layout title="Welcome to Progressively, the new feature flag solution.">
  <div class="bg-slate-900">
    <header
      class="py-20 min-h-screen flex flex-col md:grid md:grid-cols-2 gap-8 px-12 max-w-screen-2xl mx-auto items-center"
    >
      <div>
        <h1 class="text-5xl font-extrabold text-white">
          Introducing <span>Progressively</span>
        </h1>

        <p class="text-3xl text-slate-200 pt-4 leading-relaxed">
          A simple, lightweight and OpenSource feature flag software.
        </p>

        <div class="flex flex-col sm:flex-row gap-4 pt-8">
          <LinkButton
            variant="primary-inverse"
            href="https://dashboard.progressively.app/signin"
            target={"_blank"}
            id="demo-instance"
          >
            Get started
          </LinkButton>

          <LinkButton
            href="https://docs.progressively.app/"
            target={"_blank"}
            id="get-started"
            variant="secondary-inverse"
          >
            Documentation
          </LinkButton>
        </div>
      </div>

      <PullTriggerSection client:load clientComponent={clientComponent} />
    </header>
  </div>

  <main>
    <SpeedUpDevelopment client:load />

    <CanaryRelease client:load />

    <ABTesting code={abcVersions} client:load />

    <CorrelatePercentageError client:load />

    <TimeBasedRollout client:load />

    <FeatureSection />

    <GetStartedCTA />
  </main>
</Layout>

<script src="https://player.vimeo.com/api/player.js"></script>
